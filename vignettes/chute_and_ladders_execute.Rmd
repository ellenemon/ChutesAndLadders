---
title: "Chutes and Ladders Package Demonstration"
author: "Ellen Jiang"
output: pdf_document
---


```{r, error = TRUE}
source("102a_hw_02_script_Ellen_Jiang.R") 
```

\pagebreak

# Part 1: Board representation

Create a single list object called `board` where you store the features of the game board in R.

```{r, error = TRUE}
h <- 10
w <- 10
dim <- c(h, w)
ladder <- list(c(1, 38), c(4,14), c(9,31), c(21,42), c(28,84), c(36,44), c(51,67),c(71,91), c(80,100))
chute <- list(c(98,78), c(95,75), c(93,73), c(87,24), c(64,60), c(62,19), c(56,53), c(49,11), c(47,26), c(16,6))
board <- list(dim, ladder, chute)
```

\pagebreak

# Part 2: Plot of Game board

```{r, error = TRUE}
# par() should help the plot be more visible. you can adjust this as necessary
par(mar = c(0, 0, 0, 0)) 
# show_board(board)

show_board(board)
```

\pagebreak

# Part 3: Miniboards

Create the `miniboard` objects and plots.

```{r, error = TRUE}
dim <- c(6,7)
ladder <- list(c(1, 23), c(9,27), c(20,31))
chute <- list(c(16,6), c(30,18), c(35,24), c(40,26))
miniboard1 <- list(dim, ladder, chute)
par(mar = c(0, 0, 0, 0))
show_board(miniboard1)
```

```{r, error = TRUE}
dim <- c(7,9)
ladder <- list(c(9,22), c(13,30), c(24,37), c(29,41), c(33,39), c(43,54))
chute <- list(c(16,3), c(31,15), c(35,21), c(62,48))
miniboard2 <- list(dim, ladder, chute)
par(mar = c(0, 0, 0, 0))
show_board(miniboard2)
```

```{r, error = TRUE}
dim <- c(8,9)
ladder <- list(c(13,30))
chute <- list(c(31,15))
miniboard3 <- list(dim, ladder, chute)
par(mar = c(0, 0, 0, 0))
show_board(miniboard3)
```

\pagebreak

# Part 4: Verbose output of one single player game

```{r, error = TRUE}

set.seed(5)
play_solo(board, verbose = TRUE)

```

\pagebreak

# Part 5: Monte Carlo Simulation Study

```{r, error = TRUE}
library(dplyr)
total <- replicate(10000, play_solo(board, verbose = FALSE))
newturns <- as.numeric(total[1,])
newladder <- matrix(unlist(total[2,]), nrow = 10000, byrow = TRUE)
colnames(newladder) <- 1:9
newchute <- matrix(unlist(total[3,]), nrow = 10000, byrow = TRUE)
colnames(newchute) <- order(c(1:10), decreasing = TRUE)
```


- Create a histogram (breaks = 50) of the turns.

```{r}
hist(newturns, breaks = 50, main = paste("Histogram of the turns" ))
```


- Find the minimum number of turns. How many times out of 10,000 did a game finish with the minimum number of turns?
```{r}
min(newturns) #minimum nubmer of turns
length(which(newturns == 7)) # number of times out of 10,000 that min_turn occurs
```


- Find the maximum number of turns.
```{r}
max(newturns)
```


- What is the median number of turns?
```{r}
median(newturns)
```

- What is the mean number of turns?
```{r}
mean(newturns)
```

- What proportion of games take 100 or more turns to complete?
```{r}
length(which(newturns >= 100))/sum(newturns)
```

- What proportion of games take 10 or fewer turns to complete?
```{r}
length(which(newturns <= 10))/sum(newturns)
```

- What proportion of games utilize ladder 9 (the shortcut to win on space 80)?
```{r}
length(which(newladder[,9] != 0))/10000

```

- Frequency of chutes
```{r}
barplot(colSums(newchute)/sum(newchute), 
        main = "Relative Frequency of Chutes",
        names.arg = seq(10,1,-1),
        xlab = "Chute Number",
        ylab = "relative frequency")
```

- Frequency of ladders
```{r}

barplot(colSums(newladder)/sum(newladder), 
        main = "Relative Frequency of Ladders",
        xlab = "Ladder Number",
        ylab = "relative frequency")
```
